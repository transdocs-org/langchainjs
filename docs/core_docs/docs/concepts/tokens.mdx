# 令牌（Tokens）

现代大型语言模型（LLMs）通常基于一种称为 Transformer 的架构，该架构处理被称为 **令牌（tokens）** 的单元序列。令牌是模型用于分解输入和生成输出的基本元素。在本节中，我们将讨论什么是令牌，以及语言模型如何使用它们。

## 什么是令牌？

**令牌（token）** 是语言模型读取、处理和生成的基本单位。这些单位的具体形式取决于模型提供方的定义方式，但通常可以代表：

- 一个完整的单词（例如 "apple"），
- 单词的一部分（例如 "app"），
- 或其他语言成分，如标点符号或空格。

模型如何对输入进行分词取决于其 **分词器算法（tokenizer algorithm）**，该算法将输入文本转换为令牌。同样，模型的输出也是一系列令牌流，然后被解码回人类可读的文本。

## 语言模型中的令牌是如何工作的？

语言模型使用令牌的原因与其理解与预测语言的方式密切相关。相比于直接处理字符或整个句子，语言模型专注于 **令牌**，它们代表了有意义的语言单位。以下是其工作流程：

1. **输入分词（Input Tokenization）**：当你向模型提供一个提示（prompt），例如 "LangChain is cool!"，分词器算法会将文本拆分为令牌。例如，这句话可能被分词为 `["Lang", "Chain", " is", " cool", "!"]`。请注意，令牌的边界并不总是与单词边界一致。
   ![](/img/tokenization.png)

2. **处理（Processing）**：这些模型背后的 Transformer 架构会按顺序处理令牌，以预测句子中的下一个令牌。它通过分析令牌之间的关系，捕捉输入中的上下文和语义。

3. **输出生成（Output Generation）**：模型逐个生成新的令牌。这些输出令牌随后被解码回人类可读的文本。

使用令牌而非原始字符，使模型能够专注于具有语言意义的单位，从而更有效地捕捉语法、结构和上下文。

## 令牌不一定是文本

尽管令牌最常用于表示文本，但它们并不局限于文本数据。令牌也可以作为 **多模态数据（multi-modal data）** 的抽象表示，例如：

- **图像**，
- **音频**，
- **视频**，
- 以及其他类型的数据。

在撰写本文时，实际上几乎没有模型支持 **多模态输出**，只有少数模型能够处理 **多模态输入**（例如，文本结合图像或音频）。然而，随着人工智能的发展，我们预计 **多模态能力** 将变得更为普遍。这将使模型能够处理和生成更广泛的媒体内容，显著扩展令牌所能表示的内容范围，以及模型与各种数据类型的交互方式。

:::note
原则上，**任何可以表示为令牌序列的数据** 都可以以类似方式进行建模。例如，**DNA 序列** —— 由一系列核苷酸（A、T、C、G）组成 —— 可以被分词并建模，以捕捉模式、进行预测或生成序列。这种灵活性使基于 Transformer 的模型能够处理各种类型的序列数据，进一步拓展它们在生物信息学、信号处理等涉及结构化或非结构化序列的领域中的潜在应用。
:::

如需了解更多关于多模态输入和输出的信息，请参阅 [多模态](/docs/concepts/multimodality) 章节。

## 为什么不用字符？

相比使用单个字符，使用令牌可以提高模型的效率，并增强其对上下文和语法的理解能力。令牌代表了有意义的单位，如整个单词或单词的一部分，使模型能够更有效地捕捉语言结构。基于令牌的处理还减少了模型需要处理的单位数量，从而加快了计算速度。

相比之下，基于字符的处理需要处理更长的输入序列，使得模型更难学习到字符之间的关系和上下文。令牌使模型能够专注于语言意义，从而在生成响应时更加准确和高效。

## 令牌与文本的对应关系

如需了解更多关于令牌如何计数以及它们与文本之间对应关系的细节，请参阅 [OpenAI 的相关说明](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them)。

根据 OpenAI 的说明，英文文本中令牌的大致对应关系如下：

- 1 个令牌 ≈ 英文中 4 个字符
- 1 个令牌 ≈ ¾ 个单词
- 100 个令牌 ≈ 75 个单词